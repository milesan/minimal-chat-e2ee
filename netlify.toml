[build]
  # Directory to change to before starting a build.
  # This is where we will look for package.json/.nvmrc/etc.
  base = "."

  # Directory that contains the deploy-ready HTML files and assets generated by
  # the build. This is relative to the base directory if one has been set.
  publish = "dist"

  # Default build command.
  command = "npm run build"
  
  # Environment variables for production build
  environment = { VITE_API_URL = "https://minimal-chat-e2ee-production.up.railway.app", VITE_WS_URL = "https://minimal-chat-e2ee-production.up.railway.app" }

[[redirects]]
  from = "/api/*"
  to = "https://minimal-chat-e2ee-production.up.railway.app/api/:splat"
  status = 200
  force = true

[[redirects]]
  from = "/socket.io/*"
  to = "https://minimal-chat-e2ee-production.up.railway.app/socket.io/:splat"
  status = 200
  force = true

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

[dev]
  port = 5173
  targetPort = 3000
  autoLaunch = false